2025-05-29 18:45:06,226 - __main__ - INFO - Starting database seeding process...
2025-05-29 18:45:06,226 - __main__ - INFO - Fetching up to 25 listings...
2025-05-29 18:45:06,226 - __main__ - INFO - Fetching up to 25 listings...
2025-05-29 18:45:06,242 - __main__ - INFO - Fetching listings from Yad2...
2025-05-29 18:45:06,243 - __main__ - ERROR - Error in fetch_listings: 'Yad2Scraper' object has no attribute 'search'
Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 64, in fetch_listings
    results = await scraper.search(
AttributeError: 'Yad2Scraper' object has no attribute 'search'
2025-05-29 18:45:06,244 - yad2_scraper.scraper - INFO - Scraper session closed
2025-05-29 18:45:06,244 - __main__ - ERROR - Error during database seeding: object NoneType can't be used in 'await' expression
Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 296, in main_async
    listings = await fetch_listings(limit=limit)
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 100, in fetch_listings
    await scraper.close()
TypeError: object NoneType can't be used in 'await' expression
2025-05-29 18:45:06,245 - __main__ - INFO - Database seeding completed.
2025-05-29 18:47:24,613 - __main__ - INFO - Starting database seeding process...
2025-05-29 18:47:24,613 - __main__ - INFO - Fetching up to 25 listings...
2025-05-29 18:47:24,613 - __main__ - INFO - Fetching up to 25 listings...
2025-05-29 18:47:24,635 - __main__ - INFO - Fetching vehicle listings from Yad2...
2025-05-29 18:47:24,635 - __main__ - INFO - Fetching URL: https://www.yad2.co.il/vehicles/private-cars?price=0-1000000&hand=1-&year=2015-&km=-100000&priceOnly=1
2025-05-29 18:47:24,635 - yad2_scraper.scraper - INFO - Making GET request to URL: 'https://www.yad2.co.il/vehicles/private-cars?price=0-1000000&hand=1-&year=2015-&km=-100000&priceOnly=1'
2025-05-29 18:47:25,098 - httpx - INFO - HTTP Request: GET https://www.yad2.co.il/vehicles/private-cars?price=0-1000000&hand=1-&year=2015-&km=-100000&priceOnly=1 "HTTP/1.1 308 Permanent Redirect"
2025-05-29 18:47:25,349 - httpx - INFO - HTTP Request: GET https://www.yad2.co.il/vehicles/cars?price=0-1000000&hand=1-&year=2015-&km=-100000&priceOnly=1 "HTTP/1.1 200 OK"
2025-05-29 18:47:25,418 - __main__ - ERROR - Error in fetch_listings: object Response can't be used in 'await' expression
Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 73, in fetch_listings
    response = await scraper.get(url)
TypeError: object Response can't be used in 'await' expression
2025-05-29 18:47:25,419 - yad2_scraper.scraper - INFO - Scraper session closed
2025-05-29 18:47:25,420 - __main__ - ERROR - Error during database seeding: object NoneType can't be used in 'await' expression
Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 364, in main_async
    listings = await fetch_listings(limit=limit)
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 168, in fetch_listings
    await scraper.close()
TypeError: object NoneType can't be used in 'await' expression
2025-05-29 18:47:25,420 - __main__ - INFO - Database seeding completed.
2025-05-29 18:48:34,124 - __main__ - INFO - Starting database seeding process...
2025-05-29 18:48:34,125 - __main__ - INFO - Fetching up to 25 listings...
2025-05-29 18:48:34,125 - __main__ - INFO - Fetching up to 25 listings...
2025-05-29 18:48:34,137 - __main__ - INFO - Fetching vehicle listings from Yad2...
2025-05-29 18:48:34,137 - __main__ - INFO - Fetching URL: https://www.yad2.co.il/vehicles/private-cars?price=0-1000000&hand=1-&year=2015-&km=-100000&priceOnly=1
2025-05-29 18:48:35,181 - __main__ - WARNING - No listing elements found on the page
2025-05-29 18:48:35,189 - __main__ - INFO - Found 0 listing elements
2025-05-29 18:48:35,189 - yad2_scraper.scraper - INFO - Scraper session closed
2025-05-29 18:48:35,189 - __main__ - ERROR - Error during database seeding: object NoneType can't be used in 'await' expression
Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 383, in main_async
    listings = await fetch_listings(limit=limit)
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 187, in fetch_listings
    await scraper.close()
TypeError: object NoneType can't be used in 'await' expression
2025-05-29 18:48:35,192 - __main__ - INFO - Database seeding completed.
2025-05-29 18:49:19,444 - __main__ - INFO - Starting database seeding process...
2025-05-29 18:49:19,444 - __main__ - INFO - Fetching up to 25 listings...
2025-05-29 18:49:19,444 - __main__ - INFO - Fetching up to 25 listings...
2025-05-29 18:49:19,477 - __main__ - INFO - Fetching vehicle listings from Yad2...
2025-05-29 18:49:19,477 - __main__ - INFO - Fetching URL: https://www.yad2.co.il/vehicles/private-cars?price=0-1000000&hand=1-&year=2015-&km=-100000&priceOnly=1
2025-05-29 18:49:20,491 - __main__ - INFO - Saved HTML response to yad2_response.html for debugging
2025-05-29 18:49:20,548 - __main__ - WARNING - No listing elements found with standard selectors. Trying more general approach...
2025-05-29 18:49:20,555 - __main__ - INFO - Total listing elements found: 757
2025-05-29 18:49:20,556 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:49:21,888 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:49:23,377 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:49:26,180 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:49:27,614 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:49:29,352 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:49:31,860 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:49:33,931 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:49:35,885 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:49:37,299 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:49:39,374 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:49:40,907 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:49:43,060 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:49:45,055 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:49:47,168 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:49:48,662 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:49:50,484 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:49:53,139 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:49:55,289 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:49:56,761 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:49:59,422 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:50:00,845 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:50:03,622 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:50:05,066 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:50:07,862 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:50:07,862 - yad2_scraper.scraper - INFO - Scraper session closed
2025-05-29 18:50:07,862 - __main__ - ERROR - Error during database seeding: object NoneType can't be used in 'await' expression
Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 413, in main_async
    listings = await fetch_listings(limit=limit)
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 217, in fetch_listings
    await scraper.close()
TypeError: object NoneType can't be used in 'await' expression
2025-05-29 18:50:07,866 - __main__ - INFO - Database seeding completed.
2025-05-29 18:51:05,206 - __main__ - INFO - Starting database seeding process...
2025-05-29 18:51:05,207 - __main__ - INFO - Fetching up to 25 listings...
2025-05-29 18:51:05,207 - __main__ - INFO - Fetching up to 25 listings...
2025-05-29 18:51:05,373 - __main__ - INFO - Fetching URL: https://www.yad2.co.il/vehicles/private-cars?price=0-1000000&hand=1-&year=2015-&km=-100000&priceOnly=1
2025-05-29 18:51:06,212 - __main__ - INFO - Saved HTML response to yad2_response.html for debugging
2025-05-29 18:51:06,331 - __main__ - WARNING - No listing elements found with standard selectors. Trying more general approach...
2025-05-29 18:51:06,341 - __main__ - INFO - Total listing elements found: 757
2025-05-29 18:51:06,343 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:51:08,348 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:51:11,013 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:51:13,242 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:51:16,192 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:51:18,925 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:51:20,012 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:51:22,240 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:51:23,530 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:51:25,586 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:51:26,721 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:51:29,367 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:51:30,481 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:51:32,592 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:51:33,675 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:51:34,764 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:51:36,425 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:51:38,547 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:51:39,785 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:51:42,532 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:51:44,908 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:51:47,244 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:51:48,547 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:51:49,680 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:51:52,100 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:51:52,128 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '1', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 342, in save_listings_to_db
    existing = db.query(CarListing).filter_by(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '1', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-29 18:51:52,260 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '2', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 342, in save_listings_to_db
    existing = db.query(CarListing).filter_by(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '2', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-29 18:51:52,262 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '3', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 342, in save_listings_to_db
    existing = db.query(CarListing).filter_by(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '3', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-29 18:51:52,264 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '4', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 342, in save_listings_to_db
    existing = db.query(CarListing).filter_by(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '4', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-29 18:51:52,266 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '5', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 342, in save_listings_to_db
    existing = db.query(CarListing).filter_by(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '5', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-29 18:51:52,269 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '6', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 342, in save_listings_to_db
    existing = db.query(CarListing).filter_by(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '6', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-29 18:51:52,271 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '7', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 342, in save_listings_to_db
    existing = db.query(CarListing).filter_by(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '7', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-29 18:51:52,273 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '8', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 342, in save_listings_to_db
    existing = db.query(CarListing).filter_by(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '8', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-29 18:51:52,275 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '9', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 342, in save_listings_to_db
    existing = db.query(CarListing).filter_by(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '9', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-29 18:51:52,277 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '10', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 342, in save_listings_to_db
    existing = db.query(CarListing).filter_by(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '10', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-29 18:51:52,279 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '11', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 342, in save_listings_to_db
    existing = db.query(CarListing).filter_by(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '11', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-29 18:51:52,281 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '12', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 342, in save_listings_to_db
    existing = db.query(CarListing).filter_by(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '12', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-29 18:51:52,282 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '13', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 342, in save_listings_to_db
    existing = db.query(CarListing).filter_by(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '13', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-29 18:51:52,284 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '14', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 342, in save_listings_to_db
    existing = db.query(CarListing).filter_by(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '14', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-29 18:51:52,286 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '15', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 342, in save_listings_to_db
    existing = db.query(CarListing).filter_by(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '15', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-29 18:51:52,287 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '16', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 342, in save_listings_to_db
    existing = db.query(CarListing).filter_by(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '16', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-29 18:51:52,289 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '17', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 342, in save_listings_to_db
    existing = db.query(CarListing).filter_by(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '17', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-29 18:51:52,291 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '18', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 342, in save_listings_to_db
    existing = db.query(CarListing).filter_by(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '18', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-29 18:51:52,293 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '19', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 342, in save_listings_to_db
    existing = db.query(CarListing).filter_by(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '19', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-29 18:51:52,294 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '20', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 342, in save_listings_to_db
    existing = db.query(CarListing).filter_by(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '20', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-29 18:51:52,296 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '21', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 342, in save_listings_to_db
    existing = db.query(CarListing).filter_by(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '21', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-29 18:51:52,299 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '22', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 342, in save_listings_to_db
    existing = db.query(CarListing).filter_by(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '22', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-29 18:51:52,301 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '23', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 342, in save_listings_to_db
    existing = db.query(CarListing).filter_by(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '23', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-29 18:51:52,303 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '24', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 342, in save_listings_to_db
    existing = db.query(CarListing).filter_by(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '24', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-29 18:51:52,304 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '25', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 342, in save_listings_to_db
    existing = db.query(CarListing).filter_by(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column car_listings.image_url does not exist
LINE 1: ...y_type, car_listings.color AS car_listings_color, car_listin...
                                                             ^

[SQL: SELECT car_listings.id AS car_listings_id, car_listings.yad2_id AS car_listings_yad2_id, car_listings.title AS car_listings_title, car_listings.description AS car_listings_description, car_listings.price AS car_listings_price, car_listings.year AS car_listings_year, car_listings.mileage AS car_listings_mileage, car_listings.fuel_type AS car_listings_fuel_type, car_listings.transmission AS car_listings_transmission, car_listings.body_type AS car_listings_body_type, car_listings.color AS car_listings_color, car_listings.image_url AS car_listings_image_url, car_listings.status AS car_listings_status, car_listings.brand_id AS car_listings_brand_id, car_listings.model_id AS car_listings_model_id, car_listings.created_at AS car_listings_created_at, car_listings.updated_at AS car_listings_updated_at, car_listings.last_scraped_at AS car_listings_last_scraped_at 
FROM car_listings 
WHERE car_listings.yad2_id = %(yad2_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'yad2_id_1': '25', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-29 18:51:52,305 - __main__ - INFO - Successfully saved 0 listings to database
2025-05-29 18:51:52,305 - __main__ - WARNING - Failed to save 25 listings due to errors
2025-05-29 18:51:52,305 - __main__ - INFO - Processed 25 listings. Saved: 0, Errors: 25
2025-05-29 18:51:52,305 - __main__ - INFO - ==================================================
2025-05-29 18:51:52,305 - __main__ - INFO - SEEDING SUMMARY
2025-05-29 18:51:52,305 - __main__ - INFO - ==================================================
2025-05-29 18:51:52,305 - __main__ - INFO - Total saved: 0
2025-05-29 18:51:52,305 - __main__ - INFO - Total errors: 25
2025-05-29 18:51:52,306 - __main__ - INFO - Time taken: 47.10 seconds
2025-05-29 18:51:52,306 - __main__ - INFO - ==================================================
2025-05-29 18:51:52,306 - __main__ - INFO - Database seeding completed.
2025-05-29 18:54:27,415 - __main__ - INFO - Starting database seeding process...
2025-05-29 18:54:27,415 - __main__ - INFO - Fetching up to 25 listings...
2025-05-29 18:54:27,415 - __main__ - INFO - Fetching up to 25 listings...
2025-05-29 18:54:27,560 - __main__ - INFO - Fetching URL: https://www.yad2.co.il/vehicles/private-cars?price=0-1000000&hand=1-&year=2015-&km=-100000&priceOnly=1
2025-05-29 18:54:28,281 - __main__ - INFO - Saved HTML response to yad2_response.html for debugging
2025-05-29 18:54:28,338 - __main__ - WARNING - No listing elements found with standard selectors. Trying more general approach...
2025-05-29 18:54:28,344 - __main__ - INFO - Total listing elements found: 757
2025-05-29 18:54:28,346 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:54:30,666 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:54:33,257 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:54:35,686 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:54:37,398 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:54:39,938 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:54:42,313 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:54:44,022 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:54:46,903 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:54:48,552 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:54:49,930 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:54:51,025 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:54:52,661 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:54:53,930 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:54:56,091 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:54:57,105 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:54:58,948 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:55:01,232 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:55:03,952 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:55:05,907 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:55:07,591 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:55:09,281 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:55:11,637 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:55:14,263 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:55:16,236 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:55:16,283 - __main__ - ERROR - Error saving listing to database: 'source_url' is an invalid keyword argument for CarListing
Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 361, in save_listings_to_db
    listing = CarListing(**listing_data)
  File "<string>", line 4, in __init__
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 567, in _initialize_instance
    manager.dispatch.init_failure(self, args, kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/decl_base.py", line 2142, in _declarative_constructor
    raise TypeError(
TypeError: 'source_url' is an invalid keyword argument for CarListing
2025-05-29 18:55:16,336 - __main__ - ERROR - Error saving listing to database: 'source_url' is an invalid keyword argument for CarListing
Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 361, in save_listings_to_db
    listing = CarListing(**listing_data)
  File "<string>", line 4, in __init__
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 567, in _initialize_instance
    manager.dispatch.init_failure(self, args, kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/decl_base.py", line 2142, in _declarative_constructor
    raise TypeError(
TypeError: 'source_url' is an invalid keyword argument for CarListing
2025-05-29 18:55:16,340 - __main__ - ERROR - Error saving listing to database: 'source_url' is an invalid keyword argument for CarListing
Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 361, in save_listings_to_db
    listing = CarListing(**listing_data)
  File "<string>", line 4, in __init__
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 567, in _initialize_instance
    manager.dispatch.init_failure(self, args, kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/decl_base.py", line 2142, in _declarative_constructor
    raise TypeError(
TypeError: 'source_url' is an invalid keyword argument for CarListing
2025-05-29 18:55:16,344 - __main__ - ERROR - Error saving listing to database: 'source_url' is an invalid keyword argument for CarListing
Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 361, in save_listings_to_db
    listing = CarListing(**listing_data)
  File "<string>", line 4, in __init__
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 567, in _initialize_instance
    manager.dispatch.init_failure(self, args, kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/decl_base.py", line 2142, in _declarative_constructor
    raise TypeError(
TypeError: 'source_url' is an invalid keyword argument for CarListing
2025-05-29 18:55:16,348 - __main__ - ERROR - Error saving listing to database: 'source_url' is an invalid keyword argument for CarListing
Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 361, in save_listings_to_db
    listing = CarListing(**listing_data)
  File "<string>", line 4, in __init__
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 567, in _initialize_instance
    manager.dispatch.init_failure(self, args, kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/decl_base.py", line 2142, in _declarative_constructor
    raise TypeError(
TypeError: 'source_url' is an invalid keyword argument for CarListing
2025-05-29 18:55:16,352 - __main__ - ERROR - Error saving listing to database: 'source_url' is an invalid keyword argument for CarListing
Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 361, in save_listings_to_db
    listing = CarListing(**listing_data)
  File "<string>", line 4, in __init__
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 567, in _initialize_instance
    manager.dispatch.init_failure(self, args, kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/decl_base.py", line 2142, in _declarative_constructor
    raise TypeError(
TypeError: 'source_url' is an invalid keyword argument for CarListing
2025-05-29 18:55:16,356 - __main__ - ERROR - Error saving listing to database: 'source_url' is an invalid keyword argument for CarListing
Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 361, in save_listings_to_db
    listing = CarListing(**listing_data)
  File "<string>", line 4, in __init__
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 567, in _initialize_instance
    manager.dispatch.init_failure(self, args, kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/decl_base.py", line 2142, in _declarative_constructor
    raise TypeError(
TypeError: 'source_url' is an invalid keyword argument for CarListing
2025-05-29 18:55:16,360 - __main__ - ERROR - Error saving listing to database: 'source_url' is an invalid keyword argument for CarListing
Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 361, in save_listings_to_db
    listing = CarListing(**listing_data)
  File "<string>", line 4, in __init__
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 567, in _initialize_instance
    manager.dispatch.init_failure(self, args, kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/decl_base.py", line 2142, in _declarative_constructor
    raise TypeError(
TypeError: 'source_url' is an invalid keyword argument for CarListing
2025-05-29 18:55:16,365 - __main__ - ERROR - Error saving listing to database: 'source_url' is an invalid keyword argument for CarListing
Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 361, in save_listings_to_db
    listing = CarListing(**listing_data)
  File "<string>", line 4, in __init__
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 567, in _initialize_instance
    manager.dispatch.init_failure(self, args, kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/decl_base.py", line 2142, in _declarative_constructor
    raise TypeError(
TypeError: 'source_url' is an invalid keyword argument for CarListing
2025-05-29 18:55:16,369 - __main__ - ERROR - Error saving listing to database: 'source_url' is an invalid keyword argument for CarListing
Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 361, in save_listings_to_db
    listing = CarListing(**listing_data)
  File "<string>", line 4, in __init__
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 567, in _initialize_instance
    manager.dispatch.init_failure(self, args, kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/decl_base.py", line 2142, in _declarative_constructor
    raise TypeError(
TypeError: 'source_url' is an invalid keyword argument for CarListing
2025-05-29 18:55:16,373 - __main__ - ERROR - Error saving listing to database: 'source_url' is an invalid keyword argument for CarListing
Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 361, in save_listings_to_db
    listing = CarListing(**listing_data)
  File "<string>", line 4, in __init__
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 567, in _initialize_instance
    manager.dispatch.init_failure(self, args, kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/decl_base.py", line 2142, in _declarative_constructor
    raise TypeError(
TypeError: 'source_url' is an invalid keyword argument for CarListing
2025-05-29 18:55:16,377 - __main__ - ERROR - Error saving listing to database: 'source_url' is an invalid keyword argument for CarListing
Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 361, in save_listings_to_db
    listing = CarListing(**listing_data)
  File "<string>", line 4, in __init__
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 567, in _initialize_instance
    manager.dispatch.init_failure(self, args, kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/decl_base.py", line 2142, in _declarative_constructor
    raise TypeError(
TypeError: 'source_url' is an invalid keyword argument for CarListing
2025-05-29 18:55:16,381 - __main__ - ERROR - Error saving listing to database: 'source_url' is an invalid keyword argument for CarListing
Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 361, in save_listings_to_db
    listing = CarListing(**listing_data)
  File "<string>", line 4, in __init__
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 567, in _initialize_instance
    manager.dispatch.init_failure(self, args, kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/decl_base.py", line 2142, in _declarative_constructor
    raise TypeError(
TypeError: 'source_url' is an invalid keyword argument for CarListing
2025-05-29 18:55:16,384 - __main__ - ERROR - Error saving listing to database: 'source_url' is an invalid keyword argument for CarListing
Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 361, in save_listings_to_db
    listing = CarListing(**listing_data)
  File "<string>", line 4, in __init__
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 567, in _initialize_instance
    manager.dispatch.init_failure(self, args, kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/decl_base.py", line 2142, in _declarative_constructor
    raise TypeError(
TypeError: 'source_url' is an invalid keyword argument for CarListing
2025-05-29 18:55:16,388 - __main__ - ERROR - Error saving listing to database: 'source_url' is an invalid keyword argument for CarListing
Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 361, in save_listings_to_db
    listing = CarListing(**listing_data)
  File "<string>", line 4, in __init__
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 567, in _initialize_instance
    manager.dispatch.init_failure(self, args, kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/decl_base.py", line 2142, in _declarative_constructor
    raise TypeError(
TypeError: 'source_url' is an invalid keyword argument for CarListing
2025-05-29 18:55:16,391 - __main__ - ERROR - Error saving listing to database: 'source_url' is an invalid keyword argument for CarListing
Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 361, in save_listings_to_db
    listing = CarListing(**listing_data)
  File "<string>", line 4, in __init__
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 567, in _initialize_instance
    manager.dispatch.init_failure(self, args, kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/decl_base.py", line 2142, in _declarative_constructor
    raise TypeError(
TypeError: 'source_url' is an invalid keyword argument for CarListing
2025-05-29 18:55:16,395 - __main__ - ERROR - Error saving listing to database: 'source_url' is an invalid keyword argument for CarListing
Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 361, in save_listings_to_db
    listing = CarListing(**listing_data)
  File "<string>", line 4, in __init__
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 567, in _initialize_instance
    manager.dispatch.init_failure(self, args, kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/decl_base.py", line 2142, in _declarative_constructor
    raise TypeError(
TypeError: 'source_url' is an invalid keyword argument for CarListing
2025-05-29 18:55:16,399 - __main__ - ERROR - Error saving listing to database: 'source_url' is an invalid keyword argument for CarListing
Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 361, in save_listings_to_db
    listing = CarListing(**listing_data)
  File "<string>", line 4, in __init__
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 567, in _initialize_instance
    manager.dispatch.init_failure(self, args, kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/decl_base.py", line 2142, in _declarative_constructor
    raise TypeError(
TypeError: 'source_url' is an invalid keyword argument for CarListing
2025-05-29 18:55:16,402 - __main__ - ERROR - Error saving listing to database: 'source_url' is an invalid keyword argument for CarListing
Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 361, in save_listings_to_db
    listing = CarListing(**listing_data)
  File "<string>", line 4, in __init__
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 567, in _initialize_instance
    manager.dispatch.init_failure(self, args, kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/decl_base.py", line 2142, in _declarative_constructor
    raise TypeError(
TypeError: 'source_url' is an invalid keyword argument for CarListing
2025-05-29 18:55:16,405 - __main__ - ERROR - Error saving listing to database: 'source_url' is an invalid keyword argument for CarListing
Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 361, in save_listings_to_db
    listing = CarListing(**listing_data)
  File "<string>", line 4, in __init__
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 567, in _initialize_instance
    manager.dispatch.init_failure(self, args, kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/decl_base.py", line 2142, in _declarative_constructor
    raise TypeError(
TypeError: 'source_url' is an invalid keyword argument for CarListing
2025-05-29 18:55:16,409 - __main__ - ERROR - Error saving listing to database: 'source_url' is an invalid keyword argument for CarListing
Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 361, in save_listings_to_db
    listing = CarListing(**listing_data)
  File "<string>", line 4, in __init__
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 567, in _initialize_instance
    manager.dispatch.init_failure(self, args, kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/decl_base.py", line 2142, in _declarative_constructor
    raise TypeError(
TypeError: 'source_url' is an invalid keyword argument for CarListing
2025-05-29 18:55:16,412 - __main__ - ERROR - Error saving listing to database: 'source_url' is an invalid keyword argument for CarListing
Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 361, in save_listings_to_db
    listing = CarListing(**listing_data)
  File "<string>", line 4, in __init__
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 567, in _initialize_instance
    manager.dispatch.init_failure(self, args, kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/decl_base.py", line 2142, in _declarative_constructor
    raise TypeError(
TypeError: 'source_url' is an invalid keyword argument for CarListing
2025-05-29 18:55:16,416 - __main__ - ERROR - Error saving listing to database: 'source_url' is an invalid keyword argument for CarListing
Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 361, in save_listings_to_db
    listing = CarListing(**listing_data)
  File "<string>", line 4, in __init__
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 567, in _initialize_instance
    manager.dispatch.init_failure(self, args, kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/decl_base.py", line 2142, in _declarative_constructor
    raise TypeError(
TypeError: 'source_url' is an invalid keyword argument for CarListing
2025-05-29 18:55:16,419 - __main__ - ERROR - Error saving listing to database: 'source_url' is an invalid keyword argument for CarListing
Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 361, in save_listings_to_db
    listing = CarListing(**listing_data)
  File "<string>", line 4, in __init__
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 567, in _initialize_instance
    manager.dispatch.init_failure(self, args, kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/decl_base.py", line 2142, in _declarative_constructor
    raise TypeError(
TypeError: 'source_url' is an invalid keyword argument for CarListing
2025-05-29 18:55:16,423 - __main__ - ERROR - Error saving listing to database: 'source_url' is an invalid keyword argument for CarListing
Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 361, in save_listings_to_db
    listing = CarListing(**listing_data)
  File "<string>", line 4, in __init__
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 567, in _initialize_instance
    manager.dispatch.init_failure(self, args, kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state.py", line 564, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/decl_base.py", line 2142, in _declarative_constructor
    raise TypeError(
TypeError: 'source_url' is an invalid keyword argument for CarListing
2025-05-29 18:55:16,427 - __main__ - INFO - Successfully saved 0 listings to database
2025-05-29 18:55:16,427 - __main__ - WARNING - Failed to save 25 listings due to errors
2025-05-29 18:55:16,427 - __main__ - INFO - Processed 25 listings. Saved: 0, Errors: 25
2025-05-29 18:55:16,427 - __main__ - INFO - ==================================================
2025-05-29 18:55:16,427 - __main__ - INFO - SEEDING SUMMARY
2025-05-29 18:55:16,427 - __main__ - INFO - ==================================================
2025-05-29 18:55:16,427 - __main__ - INFO - Total saved: 0
2025-05-29 18:55:16,427 - __main__ - INFO - Total errors: 25
2025-05-29 18:55:16,428 - __main__ - INFO - Time taken: 49.01 seconds
2025-05-29 18:55:16,428 - __main__ - INFO - ==================================================
2025-05-29 18:55:16,428 - __main__ - INFO - Database seeding completed.
2025-05-29 18:56:33,054 - __main__ - INFO - Starting database seeding process...
2025-05-29 18:56:33,054 - __main__ - INFO - Fetching up to 25 listings...
2025-05-29 18:56:33,054 - __main__ - INFO - Fetching up to 25 listings...
2025-05-29 18:56:33,175 - __main__ - INFO - Fetching URL: https://www.yad2.co.il/vehicles/private-cars?price=0-1000000&hand=1-&year=2015-&km=-100000&priceOnly=1
2025-05-29 18:56:34,206 - __main__ - INFO - Saved HTML response to yad2_response.html for debugging
2025-05-29 18:56:34,286 - __main__ - WARNING - No listing elements found with standard selectors. Trying more general approach...
2025-05-29 18:56:34,301 - __main__ - INFO - Total listing elements found: 757
2025-05-29 18:56:34,304 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:56:35,711 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:56:37,938 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:56:39,740 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:56:41,788 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:56:43,455 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:56:45,668 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:56:47,507 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:56:49,245 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:58:01,945 - __main__ - INFO - Starting database seeding process...
2025-05-29 18:58:01,945 - __main__ - INFO - Fetching up to 25 listings...
2025-05-29 18:58:01,945 - __main__ - INFO - Fetching up to 25 listings...
2025-05-29 18:58:02,150 - __main__ - INFO - Fetching URL: https://www.yad2.co.il/vehicles/private-cars?price=0-1000000&hand=1-&year=2015-&km=-100000&priceOnly=1
2025-05-29 18:58:03,144 - __main__ - INFO - Saved HTML response to yad2_response.html for debugging
2025-05-29 18:58:03,191 - __main__ - WARNING - No listing elements found with standard selectors. Trying more general approach...
2025-05-29 18:58:03,197 - __main__ - INFO - Total listing elements found: 757
2025-05-29 18:58:03,198 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:58:04,753 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:58:06,995 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:58:08,248 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:58:09,722 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:58:12,548 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:58:15,182 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:58:16,257 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:58:17,539 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:58:20,008 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:58:22,250 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:58:24,266 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:58:25,568 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:58:26,700 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:58:28,245 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:58:30,055 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:58:33,015 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:58:34,800 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:58:35,908 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:58:37,616 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:58:38,705 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:58:41,159 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:58:42,259 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:58:44,963 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:58:47,016 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:58:47,037 - __main__ - INFO - Added new listing: 
2025-05-29 18:58:47,042 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (4, 1, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.035501+01, null, 2025-05-29 17:58:47.017027+01, https://assets.yad2.co.il/common/logo-orange.svg).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '1', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': 'https://assets.yad2.co.il/common/logo-orange.svg', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17027)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (4, 1, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.035501+01, null, 2025-05-29 17:58:47.017027+01, https://assets.yad2.co.il/common/logo-orange.svg).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 359, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (4, 1, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.035501+01, null, 2025-05-29 17:58:47.017027+01, https://assets.yad2.co.il/common/logo-orange.svg).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '1', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': 'https://assets.yad2.co.il/common/logo-orange.svg', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17027)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 18:58:47,132 - __main__ - INFO - Added new listing: 
2025-05-29 18:58:47,134 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (5, 2, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.131355+01, null, 2025-05-29 17:58:47.01704+01, https://assets.yad2.co.il/common/logo-orange.svg).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '2', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': 'https://assets.yad2.co.il/common/logo-orange.svg', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17040)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (5, 2, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.131355+01, null, 2025-05-29 17:58:47.01704+01, https://assets.yad2.co.il/common/logo-orange.svg).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 359, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (5, 2, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.131355+01, null, 2025-05-29 17:58:47.01704+01, https://assets.yad2.co.il/common/logo-orange.svg).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '2', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': 'https://assets.yad2.co.il/common/logo-orange.svg', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17040)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 18:58:47,139 - __main__ - INFO - Added new listing: 
2025-05-29 18:58:47,140 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (6, 3, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.138798+01, null, 2025-05-29 17:58:47.017048+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '3', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17048)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (6, 3, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.138798+01, null, 2025-05-29 17:58:47.017048+01, ).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 359, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (6, 3, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.138798+01, null, 2025-05-29 17:58:47.017048+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '3', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17048)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 18:58:47,146 - __main__ - INFO - Added new listing: 
2025-05-29 18:58:47,147 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (7, 4, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.145399+01, null, 2025-05-29 17:58:47.017053+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '4', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17053)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (7, 4, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.145399+01, null, 2025-05-29 17:58:47.017053+01, ).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 359, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (7, 4, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.145399+01, null, 2025-05-29 17:58:47.017053+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '4', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17053)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 18:58:47,153 - __main__ - INFO - Added new listing: 
2025-05-29 18:58:47,155 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (8, 5, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.153138+01, null, 2025-05-29 17:58:47.017058+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '5', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17058)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (8, 5, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.153138+01, null, 2025-05-29 17:58:47.017058+01, ).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 359, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (8, 5, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.153138+01, null, 2025-05-29 17:58:47.017058+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '5', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17058)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 18:58:47,160 - __main__ - INFO - Added new listing: 
2025-05-29 18:58:47,178 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (9, 6, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.159901+01, null, 2025-05-29 17:58:47.017064+01, https://assets.yad2.co.il/common/logo-orange.svg).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '6', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': 'https://assets.yad2.co.il/common/logo-orange.svg', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17064)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (9, 6, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.159901+01, null, 2025-05-29 17:58:47.017064+01, https://assets.yad2.co.il/common/logo-orange.svg).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 359, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (9, 6, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.159901+01, null, 2025-05-29 17:58:47.017064+01, https://assets.yad2.co.il/common/logo-orange.svg).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '6', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': 'https://assets.yad2.co.il/common/logo-orange.svg', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17064)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 18:58:47,184 - __main__ - INFO - Added new listing: 
2025-05-29 18:58:47,185 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (10, 7, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.183844+01, null, 2025-05-29 17:58:47.017069+01, https://assets.yad2.co.il/common/logo-orange.svg).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '7', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': 'https://assets.yad2.co.il/common/logo-orange.svg', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17069)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (10, 7, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.183844+01, null, 2025-05-29 17:58:47.017069+01, https://assets.yad2.co.il/common/logo-orange.svg).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 359, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (10, 7, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.183844+01, null, 2025-05-29 17:58:47.017069+01, https://assets.yad2.co.il/common/logo-orange.svg).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '7', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': 'https://assets.yad2.co.il/common/logo-orange.svg', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17069)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 18:58:47,190 - __main__ - INFO - Added new listing: 
2025-05-29 18:58:47,192 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (11, 8, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.190275+01, null, 2025-05-29 17:58:47.017074+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '8', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17074)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (11, 8, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.190275+01, null, 2025-05-29 17:58:47.017074+01, ).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 359, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (11, 8, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.190275+01, null, 2025-05-29 17:58:47.017074+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '8', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17074)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 18:58:47,197 - __main__ - INFO - Added new listing: 
2025-05-29 18:58:47,198 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (12, 9, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.196784+01, null, 2025-05-29 17:58:47.017079+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '9', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17079)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (12, 9, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.196784+01, null, 2025-05-29 17:58:47.017079+01, ).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 359, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (12, 9, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.196784+01, null, 2025-05-29 17:58:47.017079+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '9', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17079)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 18:58:47,204 - __main__ - INFO - Added new listing: 
2025-05-29 18:58:47,205 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (13, 10, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.203593+01, null, 2025-05-29 17:58:47.017084+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '10', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17084)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (13, 10, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.203593+01, null, 2025-05-29 17:58:47.017084+01, ).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 359, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (13, 10, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.203593+01, null, 2025-05-29 17:58:47.017084+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '10', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17084)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 18:58:47,210 - __main__ - INFO - Added new listing: 
2025-05-29 18:58:47,227 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (14, 11, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.209651+01, null, 2025-05-29 17:58:47.017089+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '11', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17089)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (14, 11, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.209651+01, null, 2025-05-29 17:58:47.017089+01, ).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 359, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (14, 11, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.209651+01, null, 2025-05-29 17:58:47.017089+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '11', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17089)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 18:58:47,233 - __main__ - INFO - Added new listing: 
2025-05-29 18:58:47,234 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (15, 12, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.232502+01, null, 2025-05-29 17:58:47.017095+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '12', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17095)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (15, 12, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.232502+01, null, 2025-05-29 17:58:47.017095+01, ).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 359, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (15, 12, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.232502+01, null, 2025-05-29 17:58:47.017095+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '12', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17095)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 18:58:47,239 - __main__ - INFO - Added new listing: 
2025-05-29 18:58:47,240 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (16, 13, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.238748+01, null, 2025-05-29 17:58:47.017101+01, https://assets.yad2.co.il/common/logo-default.svg).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '13', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': 'https://assets.yad2.co.il/common/logo-default.svg', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17101)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (16, 13, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.238748+01, null, 2025-05-29 17:58:47.017101+01, https://assets.yad2.co.il/common/logo-default.svg).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 359, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (16, 13, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.238748+01, null, 2025-05-29 17:58:47.017101+01, https://assets.yad2.co.il/common/logo-default.svg).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '13', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': 'https://assets.yad2.co.il/common/logo-default.svg', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17101)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 18:58:47,245 - __main__ - INFO - Added new listing: 
2025-05-29 18:58:47,247 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (17, 14, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.2452+01, null, 2025-05-29 17:58:47.017107+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '14', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17107)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (17, 14, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.2452+01, null, 2025-05-29 17:58:47.017107+01, ).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 359, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (17, 14, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.2452+01, null, 2025-05-29 17:58:47.017107+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '14', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17107)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 18:58:47,254 - __main__ - INFO - Added new listing: 
2025-05-29 18:58:47,256 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (18, 15, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.254322+01, null, 2025-05-29 17:58:47.017112+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '15', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17112)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (18, 15, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.254322+01, null, 2025-05-29 17:58:47.017112+01, ).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 359, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (18, 15, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.254322+01, null, 2025-05-29 17:58:47.017112+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '15', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17112)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 18:58:47,277 - __main__ - INFO - Added new listing: 
2025-05-29 18:58:47,278 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (19, 16, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.276983+01, null, 2025-05-29 17:58:47.017118+01, https://assets.yad2.co.il/common/logo-default.svg).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '16', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': 'https://assets.yad2.co.il/common/logo-default.svg', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17118)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (19, 16, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.276983+01, null, 2025-05-29 17:58:47.017118+01, https://assets.yad2.co.il/common/logo-default.svg).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 359, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (19, 16, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.276983+01, null, 2025-05-29 17:58:47.017118+01, https://assets.yad2.co.il/common/logo-default.svg).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '16', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': 'https://assets.yad2.co.il/common/logo-default.svg', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17118)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 18:58:47,283 - __main__ - INFO - Added new listing: 
2025-05-29 18:58:47,284 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (20, 17, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.28307+01, null, 2025-05-29 17:58:47.017123+01, https://assets.yad2.co.il/common/logo-default.svg).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '17', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': 'https://assets.yad2.co.il/common/logo-default.svg', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17123)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (20, 17, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.28307+01, null, 2025-05-29 17:58:47.017123+01, https://assets.yad2.co.il/common/logo-default.svg).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 359, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (20, 17, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.28307+01, null, 2025-05-29 17:58:47.017123+01, https://assets.yad2.co.il/common/logo-default.svg).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '17', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': 'https://assets.yad2.co.il/common/logo-default.svg', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17123)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 18:58:47,290 - __main__ - INFO - Added new listing: 
2025-05-29 18:58:47,291 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (21, 18, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.289709+01, null, 2025-05-29 17:58:47.017128+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '18', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17128)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (21, 18, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.289709+01, null, 2025-05-29 17:58:47.017128+01, ).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 359, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (21, 18, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.289709+01, null, 2025-05-29 17:58:47.017128+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '18', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17128)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 18:58:47,297 - __main__ - INFO - Added new listing: 
2025-05-29 18:58:47,298 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (22, 19, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.296719+01, null, 2025-05-29 17:58:47.017133+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '19', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17133)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (22, 19, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.296719+01, null, 2025-05-29 17:58:47.017133+01, ).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 359, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (22, 19, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.296719+01, null, 2025-05-29 17:58:47.017133+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '19', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17133)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 18:58:47,304 - __main__ - INFO - Added new listing: 
2025-05-29 18:58:47,305 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (23, 20, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.303113+01, null, 2025-05-29 17:58:47.017138+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '20', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17138)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (23, 20, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.303113+01, null, 2025-05-29 17:58:47.017138+01, ).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 359, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (23, 20, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.303113+01, null, 2025-05-29 17:58:47.017138+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '20', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17138)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 18:58:47,310 - __main__ - INFO - Added new listing: 
2025-05-29 18:58:47,327 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (24, 21, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.310091+01, null, 2025-05-29 17:58:47.017143+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '21', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17143)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (24, 21, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.310091+01, null, 2025-05-29 17:58:47.017143+01, ).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 359, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (24, 21, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.310091+01, null, 2025-05-29 17:58:47.017143+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '21', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17143)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 18:58:47,332 - __main__ - INFO - Added new listing: 
2025-05-29 18:58:47,333 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (25, 22, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.332059+01, null, 2025-05-29 17:58:47.017147+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '22', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17147)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (25, 22, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.332059+01, null, 2025-05-29 17:58:47.017147+01, ).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 359, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (25, 22, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.332059+01, null, 2025-05-29 17:58:47.017147+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '22', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17147)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 18:58:47,338 - __main__ - INFO - Added new listing: 
2025-05-29 18:58:47,339 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (26, 23, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.337943+01, null, 2025-05-29 17:58:47.017152+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '23', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17152)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (26, 23, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.337943+01, null, 2025-05-29 17:58:47.017152+01, ).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 359, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (26, 23, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.337943+01, null, 2025-05-29 17:58:47.017152+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '23', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17152)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 18:58:47,356 - __main__ - INFO - Added new listing: 
2025-05-29 18:58:47,401 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (27, 24, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.343752+01, null, 2025-05-29 17:58:47.017166+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '24', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17166)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (27, 24, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.343752+01, null, 2025-05-29 17:58:47.017166+01, ).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 359, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (27, 24, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.343752+01, null, 2025-05-29 17:58:47.017166+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '24', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17166)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 18:58:47,409 - __main__ - INFO - Added new listing: 
2025-05-29 18:58:47,428 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (28, 25, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.407696+01, null, 2025-05-29 17:58:47.017172+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '25', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17172)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (28, 25, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.407696+01, null, 2025-05-29 17:58:47.017172+01, ).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 359, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "year" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (28, 25, , , 0, null, null, , , , , ACTIVE, null, null, 2025-05-29 18:58:47.407696+01, null, 2025-05-29 17:58:47.017172+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '25', 'title': '', 'description': '', 'price': 0, 'year': None, 'mileage': None, 'fuel_type': '', 'transmission': '', 'body_type': '', 'color': '', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 17, 58, 47, 17172)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 18:58:47,436 - __main__ - INFO - Successfully saved 0 listings to database
2025-05-29 18:58:47,436 - __main__ - WARNING - Failed to save 25 listings due to errors
2025-05-29 18:58:47,437 - __main__ - INFO - Processed 25 listings. Saved: 0, Errors: 25
2025-05-29 18:58:47,437 - __main__ - INFO - ==================================================
2025-05-29 18:58:47,437 - __main__ - INFO - SEEDING SUMMARY
2025-05-29 18:58:47,437 - __main__ - INFO - ==================================================
2025-05-29 18:58:47,437 - __main__ - INFO - Total saved: 0
2025-05-29 18:58:47,437 - __main__ - INFO - Total errors: 25
2025-05-29 18:58:47,437 - __main__ - INFO - Time taken: 45.49 seconds
2025-05-29 18:58:47,437 - __main__ - INFO - ==================================================
2025-05-29 18:58:47,437 - __main__ - INFO - Database seeding completed.
2025-05-29 18:59:52,774 - __main__ - INFO - Starting database seeding process...
2025-05-29 18:59:52,774 - __main__ - INFO - Fetching up to 25 listings...
2025-05-29 18:59:52,774 - __main__ - INFO - Fetching up to 25 listings...
2025-05-29 18:59:52,914 - __main__ - INFO - Fetching URL: https://www.yad2.co.il/vehicles/private-cars?price=0-1000000&hand=1-&year=2015-&km=-100000&priceOnly=1
2025-05-29 18:59:53,669 - __main__ - INFO - Saved HTML response to yad2_response.html for debugging
2025-05-29 18:59:53,722 - __main__ - WARNING - No listing elements found with standard selectors. Trying more general approach...
2025-05-29 18:59:53,729 - __main__ - INFO - Total listing elements found: 757
2025-05-29 18:59:53,730 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:59:55,720 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:59:56,800 - __main__ - INFO - Extracted listing: ...
2025-05-29 18:59:58,885 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:00:01,473 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:00:03,679 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:00:05,781 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:00:07,777 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:00:10,712 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:00:13,086 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:00:15,241 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:00:17,161 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:00:18,570 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:00:19,600 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:00:22,598 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:00:23,622 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:00:25,777 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:00:27,048 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:00:29,738 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:00:32,283 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:00:33,881 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:00:35,680 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:00:36,997 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:00:39,281 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:00:40,518 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:00:40,538 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:00:40,543 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (29, 1, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.536173+01, null, 2025-05-29 18:00:40.518324+01, https://assets.yad2.co.il/common/logo-orange.svg).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '1', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': 'https://assets.yad2.co.il/common/logo-orange.svg', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518324)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (29, 1, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.536173+01, null, 2025-05-29 18:00:40.518324+01, https://assets.yad2.co.il/common/logo-orange.svg).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 398, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (29, 1, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.536173+01, null, 2025-05-29 18:00:40.518324+01, https://assets.yad2.co.il/common/logo-orange.svg).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '1', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': 'https://assets.yad2.co.il/common/logo-orange.svg', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518324)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 19:00:40,589 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:00:40,591 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (30, 2, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.589115+01, null, 2025-05-29 18:00:40.518337+01, https://assets.yad2.co.il/common/logo-orange.svg).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '2', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': 'https://assets.yad2.co.il/common/logo-orange.svg', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518337)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (30, 2, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.589115+01, null, 2025-05-29 18:00:40.518337+01, https://assets.yad2.co.il/common/logo-orange.svg).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 398, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (30, 2, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.589115+01, null, 2025-05-29 18:00:40.518337+01, https://assets.yad2.co.il/common/logo-orange.svg).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '2', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': 'https://assets.yad2.co.il/common/logo-orange.svg', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518337)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 19:00:40,597 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:00:40,599 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (31, 3, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.596796+01, null, 2025-05-29 18:00:40.518343+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '3', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518343)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (31, 3, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.596796+01, null, 2025-05-29 18:00:40.518343+01, ).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 398, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (31, 3, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.596796+01, null, 2025-05-29 18:00:40.518343+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '3', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518343)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 19:00:40,604 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:00:40,606 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (32, 4, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.604254+01, null, 2025-05-29 18:00:40.518348+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '4', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518348)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (32, 4, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.604254+01, null, 2025-05-29 18:00:40.518348+01, ).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 398, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (32, 4, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.604254+01, null, 2025-05-29 18:00:40.518348+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '4', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518348)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 19:00:40,628 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:00:40,630 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (33, 5, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.627678+01, null, 2025-05-29 18:00:40.518353+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '5', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518353)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (33, 5, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.627678+01, null, 2025-05-29 18:00:40.518353+01, ).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 398, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (33, 5, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.627678+01, null, 2025-05-29 18:00:40.518353+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '5', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518353)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 19:00:40,637 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:00:40,638 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (34, 6, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.636582+01, null, 2025-05-29 18:00:40.518359+01, https://assets.yad2.co.il/common/logo-orange.svg).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '6', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': 'https://assets.yad2.co.il/common/logo-orange.svg', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518359)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (34, 6, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.636582+01, null, 2025-05-29 18:00:40.518359+01, https://assets.yad2.co.il/common/logo-orange.svg).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 398, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (34, 6, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.636582+01, null, 2025-05-29 18:00:40.518359+01, https://assets.yad2.co.il/common/logo-orange.svg).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '6', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': 'https://assets.yad2.co.il/common/logo-orange.svg', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518359)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 19:00:40,644 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:00:40,646 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (35, 7, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.643883+01, null, 2025-05-29 18:00:40.518364+01, https://assets.yad2.co.il/common/logo-orange.svg).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '7', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': 'https://assets.yad2.co.il/common/logo-orange.svg', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518364)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (35, 7, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.643883+01, null, 2025-05-29 18:00:40.518364+01, https://assets.yad2.co.il/common/logo-orange.svg).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 398, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (35, 7, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.643883+01, null, 2025-05-29 18:00:40.518364+01, https://assets.yad2.co.il/common/logo-orange.svg).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '7', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': 'https://assets.yad2.co.il/common/logo-orange.svg', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518364)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 19:00:40,652 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:00:40,655 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (36, 8, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.651793+01, null, 2025-05-29 18:00:40.518369+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '8', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518369)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (36, 8, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.651793+01, null, 2025-05-29 18:00:40.518369+01, ).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 398, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (36, 8, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.651793+01, null, 2025-05-29 18:00:40.518369+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '8', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518369)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 19:00:40,678 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:00:40,680 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (37, 9, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.677657+01, null, 2025-05-29 18:00:40.518373+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '9', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518373)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (37, 9, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.677657+01, null, 2025-05-29 18:00:40.518373+01, ).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 398, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (37, 9, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.677657+01, null, 2025-05-29 18:00:40.518373+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '9', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518373)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 19:00:40,686 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:00:40,688 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (38, 10, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.685781+01, null, 2025-05-29 18:00:40.518378+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '10', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518378)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (38, 10, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.685781+01, null, 2025-05-29 18:00:40.518378+01, ).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 398, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (38, 10, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.685781+01, null, 2025-05-29 18:00:40.518378+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '10', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518378)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 19:00:40,695 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:00:40,696 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (39, 11, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.694578+01, null, 2025-05-29 18:00:40.518383+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '11', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518383)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (39, 11, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.694578+01, null, 2025-05-29 18:00:40.518383+01, ).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 398, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (39, 11, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.694578+01, null, 2025-05-29 18:00:40.518383+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '11', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518383)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 19:00:40,703 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:00:40,704 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (40, 12, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.702485+01, null, 2025-05-29 18:00:40.518388+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '12', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518388)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (40, 12, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.702485+01, null, 2025-05-29 18:00:40.518388+01, ).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 398, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (40, 12, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.702485+01, null, 2025-05-29 18:00:40.518388+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '12', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518388)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 19:00:40,710 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:00:40,728 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (41, 13, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.709771+01, null, 2025-05-29 18:00:40.518393+01, https://assets.yad2.co.il/common/logo-default.svg).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '13', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': 'https://assets.yad2.co.il/common/logo-default.svg', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518393)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (41, 13, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.709771+01, null, 2025-05-29 18:00:40.518393+01, https://assets.yad2.co.il/common/logo-default.svg).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 398, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (41, 13, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.709771+01, null, 2025-05-29 18:00:40.518393+01, https://assets.yad2.co.il/common/logo-default.svg).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '13', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': 'https://assets.yad2.co.il/common/logo-default.svg', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518393)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 19:00:40,734 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:00:40,736 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (42, 14, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.734041+01, null, 2025-05-29 18:00:40.518398+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '14', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518398)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (42, 14, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.734041+01, null, 2025-05-29 18:00:40.518398+01, ).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 398, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (42, 14, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.734041+01, null, 2025-05-29 18:00:40.518398+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '14', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518398)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 19:00:40,742 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:00:40,744 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (43, 15, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.742311+01, null, 2025-05-29 18:00:40.518402+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '15', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518402)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (43, 15, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.742311+01, null, 2025-05-29 18:00:40.518402+01, ).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 398, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (43, 15, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.742311+01, null, 2025-05-29 18:00:40.518402+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '15', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518402)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 19:00:40,752 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:00:40,754 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (44, 16, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.751704+01, null, 2025-05-29 18:00:40.518407+01, https://assets.yad2.co.il/common/logo-default.svg).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '16', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': 'https://assets.yad2.co.il/common/logo-default.svg', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518407)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (44, 16, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.751704+01, null, 2025-05-29 18:00:40.518407+01, https://assets.yad2.co.il/common/logo-default.svg).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 398, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (44, 16, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.751704+01, null, 2025-05-29 18:00:40.518407+01, https://assets.yad2.co.il/common/logo-default.svg).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '16', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': 'https://assets.yad2.co.il/common/logo-default.svg', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518407)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 19:00:40,778 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:00:40,781 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (45, 17, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.760787+01, null, 2025-05-29 18:00:40.518412+01, https://assets.yad2.co.il/common/logo-default.svg).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '17', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': 'https://assets.yad2.co.il/common/logo-default.svg', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518412)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (45, 17, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.760787+01, null, 2025-05-29 18:00:40.518412+01, https://assets.yad2.co.il/common/logo-default.svg).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 398, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (45, 17, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.760787+01, null, 2025-05-29 18:00:40.518412+01, https://assets.yad2.co.il/common/logo-default.svg).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '17', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': 'https://assets.yad2.co.il/common/logo-default.svg', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518412)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 19:00:40,789 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:00:40,790 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (46, 18, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.788533+01, null, 2025-05-29 18:00:40.518416+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '18', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518416)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (46, 18, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.788533+01, null, 2025-05-29 18:00:40.518416+01, ).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 398, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (46, 18, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.788533+01, null, 2025-05-29 18:00:40.518416+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '18', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518416)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 19:00:40,796 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:00:40,798 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (47, 19, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.796008+01, null, 2025-05-29 18:00:40.518421+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '19', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518421)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (47, 19, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.796008+01, null, 2025-05-29 18:00:40.518421+01, ).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 398, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (47, 19, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.796008+01, null, 2025-05-29 18:00:40.518421+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '19', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518421)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 19:00:40,829 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:00:40,830 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (48, 20, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.827671+01, null, 2025-05-29 18:00:40.518426+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '20', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518426)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (48, 20, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.827671+01, null, 2025-05-29 18:00:40.518426+01, ).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 398, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (48, 20, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.827671+01, null, 2025-05-29 18:00:40.518426+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '20', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518426)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 19:00:40,836 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:00:40,838 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (49, 21, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.836073+01, null, 2025-05-29 18:00:40.518431+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '21', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518431)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (49, 21, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.836073+01, null, 2025-05-29 18:00:40.518431+01, ).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 398, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (49, 21, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.836073+01, null, 2025-05-29 18:00:40.518431+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '21', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518431)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 19:00:40,929 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:00:40,931 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (50, 22, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.90705+01, null, 2025-05-29 18:00:40.518435+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '22', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518435)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (50, 22, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.90705+01, null, 2025-05-29 18:00:40.518435+01, ).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 398, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (50, 22, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.90705+01, null, 2025-05-29 18:00:40.518435+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '22', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518435)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 19:00:40,938 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:00:40,940 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (51, 23, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.937374+01, null, 2025-05-29 18:00:40.51844+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '23', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518440)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (51, 23, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.937374+01, null, 2025-05-29 18:00:40.51844+01, ).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 398, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (51, 23, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.937374+01, null, 2025-05-29 18:00:40.51844+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '23', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518440)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 19:00:40,947 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:00:40,948 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (52, 24, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.946312+01, null, 2025-05-29 18:00:40.518444+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '24', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518444)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (52, 24, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.946312+01, null, 2025-05-29 18:00:40.518444+01, ).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 398, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (52, 24, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.946312+01, null, 2025-05-29 18:00:40.518444+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '24', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518444)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 19:00:40,978 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:00:40,980 - __main__ - ERROR - Error saving listing to database: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (53, 25, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.977743+01, null, 2025-05-29 18:00:40.518449+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '25', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518449)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (53, 25, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.977743+01, null, 2025-05-29 18:00:40.518449+01, ).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Documents/repos/windauto/seed_database.py", line 398, in save_listings_to_db
    db.commit()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1969, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1256, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 1231, in _prepare_impl
    self.session.flush()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4312, in flush
    self._flush(objects)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    transaction.rollback(_capture_exception=True)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py", line 4408, in _flush
    flush_context.execute()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/persistence.py", line 1226, in _emit_insert_statements
    result = connection.execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "brand_id" of relation "car_listings" violates not-null constraint
DETAIL:  Failing row contains (53, 25, No Title, No description available, 0, 2020, null, Unknown, Unknown, Sedan, Not specified, ACTIVE, null, null, 2025-05-29 19:00:40.977743+01, null, 2025-05-29 18:00:40.518449+01, ).

[SQL: INSERT INTO car_listings (yad2_id, title, description, price, year, mileage, fuel_type, transmission, body_type, color, image_url, status, brand_id, model_id, updated_at, last_scraped_at) VALUES (%(yad2_id)s, %(title)s, %(description)s, %(price)s, %(year)s, %(mileage)s, %(fuel_type)s, %(transmission)s, %(body_type)s, %(color)s, %(image_url)s, %(status)s, %(brand_id)s, %(model_id)s, %(updated_at)s, %(last_scraped_at)s) RETURNING car_listings.id, car_listings.created_at]
[parameters: {'yad2_id': '25', 'title': 'No Title', 'description': 'No description available', 'price': 0, 'year': 2020, 'mileage': None, 'fuel_type': 'Unknown', 'transmission': 'Unknown', 'body_type': 'Sedan', 'color': 'Not specified', 'image_url': '', 'status': 'ACTIVE', 'brand_id': None, 'model_id': None, 'updated_at': None, 'last_scraped_at': datetime.datetime(2025, 5, 29, 18, 0, 40, 518449)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-05-29 19:00:40,985 - __main__ - INFO - Successfully saved 0 listings to database
2025-05-29 19:00:40,985 - __main__ - WARNING - Failed to save 25 listings due to errors
2025-05-29 19:00:40,985 - __main__ - INFO - Processed 25 listings. Saved: 0, Errors: 25
2025-05-29 19:00:40,985 - __main__ - INFO - ==================================================
2025-05-29 19:00:40,985 - __main__ - INFO - SEEDING SUMMARY
2025-05-29 19:00:40,985 - __main__ - INFO - ==================================================
2025-05-29 19:00:40,985 - __main__ - INFO - Total saved: 0
2025-05-29 19:00:40,985 - __main__ - INFO - Total errors: 25
2025-05-29 19:00:40,985 - __main__ - INFO - Time taken: 48.21 seconds
2025-05-29 19:00:40,985 - __main__ - INFO - ==================================================
2025-05-29 19:00:40,985 - __main__ - INFO - Database seeding completed.
2025-05-29 19:01:24,385 - __main__ - INFO - Starting database seeding process...
2025-05-29 19:01:24,386 - __main__ - INFO - Fetching up to 25 listings...
2025-05-29 19:01:24,386 - __main__ - INFO - Fetching up to 25 listings...
2025-05-29 19:01:25,135 - __main__ - INFO - Fetching URL: https://www.yad2.co.il/vehicles/private-cars?price=0-1000000&hand=1-&year=2015-&km=-100000&priceOnly=1
2025-05-29 19:01:26,131 - __main__ - INFO - Saved HTML response to yad2_response.html for debugging
2025-05-29 19:01:26,183 - __main__ - WARNING - No listing elements found with standard selectors. Trying more general approach...
2025-05-29 19:01:26,190 - __main__ - INFO - Total listing elements found: 757
2025-05-29 19:01:26,191 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:01:27,232 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:01:29,031 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:01:31,230 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:01:33,543 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:01:36,190 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:01:37,759 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:01:38,889 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:01:40,659 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:01:41,738 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:01:44,624 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:01:46,209 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:01:48,506 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:01:49,996 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:01:52,114 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:01:54,167 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:01:56,435 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:01:57,586 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:01:59,193 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:02:00,911 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:02:02,770 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:02:04,949 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:02:05,958 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:02:08,297 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:02:09,791 - __main__ - INFO - Extracted listing: ...
2025-05-29 19:02:09,835 - __main__ - INFO - Created new brand: Unknown
2025-05-29 19:02:09,854 - __main__ - INFO - Created new model: Unknown for brand ID 4
2025-05-29 19:02:09,859 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:02:09,967 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:02:10,073 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:02:10,183 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:02:10,292 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:02:10,399 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:02:10,507 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:02:10,616 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:02:10,727 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:02:10,835 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:02:10,946 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:02:11,053 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:02:11,162 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:02:11,270 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:02:11,378 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:02:11,486 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:02:11,596 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:02:11,706 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:02:11,815 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:02:11,924 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:02:12,033 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:02:12,141 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:02:12,250 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:02:12,357 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:02:12,467 - __main__ - INFO - Added new listing: No Title
2025-05-29 19:02:12,573 - __main__ - INFO - Successfully saved 25 listings to database
2025-05-29 19:02:12,573 - __main__ - INFO - Processed 25 listings. Saved: 25, Errors: 0
2025-05-29 19:02:12,573 - __main__ - INFO - ==================================================
2025-05-29 19:02:12,574 - __main__ - INFO - SEEDING SUMMARY
2025-05-29 19:02:12,574 - __main__ - INFO - ==================================================
2025-05-29 19:02:12,574 - __main__ - INFO - Total saved: 25
2025-05-29 19:02:12,574 - __main__ - INFO - Total errors: 0
2025-05-29 19:02:12,574 - __main__ - INFO - Time taken: 48.19 seconds
2025-05-29 19:02:12,574 - __main__ - INFO - ==================================================
2025-05-29 19:02:12,574 - __main__ - INFO - Database seeding completed.
